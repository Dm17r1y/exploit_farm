#!/usr/bin/env python

import os
import socket
import sys

HOST = sys.argv[1]
PORT = 12347
TIMEOUT = 5

PAYLOAD = b"INSERT SHELLCODE HERE\n"


def readline(s):
    "Just an example how to read a line from a socket"
    chars = []
    while True:
        a = s.recv(1)
        chars.append(a)
        if a == "\n" or a == "":
            return "".join(chars)

# force line buffering for stdout. Useful for long-running sploits
sys.stdout = os.fdopen(sys.stdout.fileno(), 'w', 1)

s = socket.create_connection((HOST, PORT), TIMEOUT)

s.sendall("gimmeflags\n")
s.recv(1337)
s.sendall(PAYLOAD)

print s.recv(1337)
